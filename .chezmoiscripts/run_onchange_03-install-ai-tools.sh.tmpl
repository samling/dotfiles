#!/usr/bin/env bash

{{- $osID := .system.os_type }}
{{- $hostname := .chezmoi.hostname -}}
{{- $hostData := index .host $hostname -}}
{{- $enabledGroups := list -}}

{{- /* Get enabled package groups for this host */}}
{{- if and $hostData (hasKey $hostData "packageGroups") (hasKey $hostData.packageGroups "enabled") -}}
  {{- $enabledGroups = $hostData.packageGroups.enabled -}}
{{- end -}}

{{- if has "ai" $enabledGroups }}
echo "Installing AI tools for {{ $osID }}..."

# # Check if go is installed
# if ! command -v go &> /dev/null; then
#     echo "Go is required to install ai tools. Please install go first."
#     exit 1
# fi

{{- if eq $osID "darwin" }}
# On macOS, use Homebrew if available
if command -v brew &> /dev/null; then
    brew install --cask claude-code
else
    echo "Brew is not installed; skipping ai tools installation"
fi
{{- else }}
curl -fsSL https://claude.ai/install.sh | bash
{{- end }}
{{- else }}
echo "Skipping ai tools installation - ai group not enabled"
{{- end }} 
